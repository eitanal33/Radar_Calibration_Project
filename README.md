# Radar Calibration Project

## Overview
This project focuses on the calibration of radar data to align it with GPS data. The goal is to correct for errors (deltas) in the radar's azimuth and position readings by training a neural network that can accurately predict the delta corrections. The neural network is trained to minimize the difference between the radar plot coordinates and the GPS coordinates.

## Table of Contents
- [Overview](#overview)
- [Project Structure](#project-structure)
- [Dataset Generation](#dataset-generation)
- [Model Description](#model-description)
- [Installation](#installation)
- [Usage](#usage)
- [Visualization](#visualization)
- [Results](#results)
- [Contributing](#contributing)
- [License](#license)

## Project Structure
The project contains the following main files and directories:
/data - data_creation.csv # Script for dataset generation - gps_data.csv # GPS data for the tracks - gps_data_good1.csv # Example of high-quality GPS data - radar_data.csv # Radar data - radar_data_good1.csv # Example of good radar data - radar_data_random.csv # Random radar data for testing - track_data.csv # Track data generated for the simulation

/logs - TensorBoard logs and model training logs

/models - delta_layer.py # Implementation of the delta correction layer - radar_calibration_model.py # TensorFlow model for radar calibration

/Testing - config.py # Configuration for testing the model - test_model.py # Script to evaluate the model with hardcoded weights

/training - custom_training_loop.py # Custom training loop implementation - train_model.py # Script to train the radar calibration model

/utils - alpha_range_calc.py # Calculation of alpha range - custom_loss.py # Custom loss function implementation - data_loader.py # Data loading utilities - logger.py # Logger setup for the project - visualization.py # Plotting and visualization utilities

/checkpoint - model_weights.ckpt # Checkpoint files for model weights

main.py # Main entry point for the project best_weights.md # Documentation of the best model weights data_set_creation_explanation.md # Explanation of dataset creation logs.json # JSON file for logging model_weights.h5 # Model weights in H5 format model_weights.txt # Text representation of model weights



## Dataset Generation
The dataset is created by simulating a walking or driving path and calculating radar measurements based on this path. The process involves:
1. **True Radar Data**: Fixed UTM coordinates and azimuth of the radar.
2. **Simulated Track Data**: True GPS coordinates of the moving object (person/vehicle).
3. **False Data**: Generated by applying constant deltas to simulate errors in the radar's measurements.

The generated dataset has 2000 points and includes fields such as:
- `utm_x_radar`, `utm_y_radar`: Fixed radar position.
- `gps_x`, `gps_y`: True GPS coordinates of the track.
- `range`, `alpha`: Calculated from the true radar position.
- `az_radar`, `az_track`: Radar azimuth with intentional deltas.
- `plot_x`, `plot_y`: Radar-detected plot coordinates with errors.

## Model Description
The neural network model (RadarCalibrationModel) is implemented using TensorFlow. It is designed to:
- Take radar data as input.
- Predict the delta corrections for UTM X/Y coordinates and azimuth.
- Minimize the Mean Squared Error (MSE) between the radar plot and GPS plot.

### Training Objective
The objective of the model is to learn the delta corrections that align the radar's false measurements to the true GPS positions.

## Installation
To set up the project, follow these steps:


```bash
# Clone the repository
git clone https://github.com/eitanal33/radar-calibration.git
cd radar-calibration
```

### Usage

#### Generating the Dataset
To generate a dataset simulating the radar and GPS data, run:
```bash
python data/data_creation.py
```

### Training the Model
To train the model, use:
```bash
python main.py
```


## Visualization
The generated dataset and model predictions can be visualized using the included plotting functionality:
- The **GPS Track** represents the true path of movement.
- The **Radar Plot** shows the radar-detected points after applying the delta corrections.

### Plot Example
![Radar and GPS Track Visualization](plots/generated_plots.png)

## Results
The neural network aims to reduce the error between the radar plot and GPS plot. The accuracy of the model is evaluated using Mean Squared Error (MSE), with improvements visualized using TensorBoard.

### TensorBoard
To visualize the model's training progress and loss function:
```bash
tensorboard --logdir=logs
```



